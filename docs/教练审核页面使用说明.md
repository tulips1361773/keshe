# 教练审核页面使用说明

## 功能概述

教练审核页面是乒乓球训练管理系统的核心功能之一，允许教练查看和处理学员的师生关系申请。

## 主要功能

### 1. 申请列表展示
- 显示所有向该教练提交的师生关系申请
- 支持按状态筛选（全部、待审核、已通过、已拒绝）
- 分页显示，每页可调整显示数量
- 实时统计各状态申请数量

### 2. 申请信息展示
- 学员基本信息（姓名、用户名、联系方式）
- 申请时间
- 当前状态
- 处理时间（如已处理）

### 3. 审核操作
- **同意申请**：建立师生关系，发送通知给学员
- **拒绝申请**：拒绝师生关系，发送通知给学员
- 操作前需要确认，防止误操作

## 使用步骤

### 1. 登录系统
```
测试账号：test_coach
测试密码：testpass123
```

### 2. 访问教学管理页面
- 登录后在导航菜单中选择"教学管理"
- 或直接访问：http://localhost:3001/teaching

### 3. 查看申请列表
- 页面会自动加载当前教练的所有申请
- 使用顶部筛选器按状态查看
- 查看统计卡片了解申请概况

### 4. 处理申请
- 点击"同意"按钮批准申请
- 点击"拒绝"按钮拒绝申请
- 确认操作后系统会自动更新状态并发送通知

## 技术实现

### 前端组件
- **文件位置**：`frontend/src/components/TeachingManagement.vue`
- **技术栈**：Vue 3 + Element Plus
- **主要功能**：
  - 数据展示和筛选
  - 分页处理
  - 审核操作
  - 状态管理

### 后端API
- **基础路径**：`/api/reservations/relations/`
- **主要接口**：
  - `GET /api/reservations/relations/` - 获取申请列表
  - `POST /api/reservations/relations/{id}/approve/` - 同意申请
  - `POST /api/reservations/relations/{id}/reject/` - 拒绝申请

### 数据模型
- **CoachStudentRelation**：师生关系模型
  - coach：教练用户
  - student：学员用户
  - status：状态（pending/approved/rejected）
  - created_at：申请时间
  - processed_at：处理时间

## 权限控制

- 只有教练用户可以访问审核页面
- 教练只能看到向自己提交的申请
- 只有相关的教练或学员可以处理申请
- 只能处理状态为"pending"的申请

## 通知系统

- 审核操作完成后自动发送通知
- 通知内容包括审核结果和相关信息
- 学员可在通知中心查看审核结果

## 测试数据

系统提供了完整的测试数据：
- 1个测试教练：测试教练 (test_coach)
- 4个测试学员：张三、李四、王五、赵六
- 不同状态的申请：2个待审核、1个已通过、1个已拒绝

## 故障排除

### 常见问题

1. **页面无法加载**
   - 检查前端服务器是否启动：`npm run dev`
   - 检查后端服务器是否启动：`python manage.py runserver`

2. **API请求失败**
   - 检查用户是否已登录
   - 检查用户权限是否正确
   - 查看浏览器控制台错误信息

3. **数据不显示**
   - 确认测试数据是否存在
   - 运行：`python create_test_approval_data.py`

### 日志查看

- 前端日志：浏览器开发者工具控制台
- 后端日志：Django服务器终端输出

## 开发说明

### 扩展功能

如需添加新功能，可以考虑：
- 批量审核操作
- 申请理由展示
- 审核历史记录
- 导出功能

### 代码结构

```
前端组件结构：
├── template（模板）
│   ├── 统计卡片
│   ├── 筛选器
│   ├── 申请列表
│   └── 分页组件
├── script（逻辑）
│   ├── 数据获取
│   ├── 审核操作
│   └── 状态管理
└── style（样式）
    └── 响应式布局
```

## 更新日志

- **v1.0**：基础审核功能实现
- 申请列表展示
- 审核操作（同意/拒绝）
- 通知系统集成
- 权限控制

---

**注意**：本系统为教学演示项目，生产环境使用需要进一步的安全性和性能优化。